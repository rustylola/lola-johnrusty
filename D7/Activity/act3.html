<!DOCTYPE html>
<html>
<head>
  <title>Activity 3: Shopping Cart</title>
</head>
<style>
    .container{
        height: 100%;
        width: 50%;
        margin: 0 auto;
    }
</style>
<body>
  <div class="container">
    <br>
    <h1>Shopping Cart</h1>
    <h2>Your Cart</h2>
    <ul id="mycart">
        
    </ul>
    <p>Total Price: &dollar;<span id="prd-total">0.00</span></p>
    <button onclick="checkout()">Checkout</button>
    <h2>Products</h2>
    <ul id="itemlist">
        <li>
            Product 
            <span class="itm-num">1</span>&nbsp;
            <span class="itm-price">&dollar;10.00</span>
            <button class="add" onclick="addCart(this)" item-num="1" item-price="10.00">Add to Cart</button>
        </li>
        <li>
            Product 
            <span class="itm-num">2</span>&nbsp;
            <span class="itm-price">&dollar;15.00</span>
            <button class="add" onclick="addCart(this)" item-num="2" item-price="15.00">Add to Cart</button>
        </li>
        <li>
            Product 
            <span class="itm-num">3</span>&nbsp;
            <span class="itm-price">&dollar;20.00</span>
            <button class="add" onclick="addCart(this)" item-num="3" item-price="20.00">Add to Cart</button>
        </li>
    </ul>
  </div>
  <script > //src="script3.js"
    
    let cart = new Object();
    let getMyList = document.getElementById('mycart');

    function items(){
        let insertNode = document.createElement('li');
        let findMyCart = document.getElementById('mycart');
        let getPrdDisplay = document.getElementById('prd-total');
        let totalCart = 0;
        findMyCart.innerHTML = '';
        Object.keys(cart).forEach((key) => {
            if(cart[key].itemCount != 0){
                findMyCart.innerHTML += `
                <li>
                    Product 
                    <span class="prd-num">${cart[key].itemNumber}</span>&nbsp;
                    <span class="prd-price">${cart[key].itemPrice}</span>
                    <button class="remove"  item-num="${cart[key].itemNumber}" item-price="${cart[key].itemPrice}" onclick="removeCart(this)">Remove</button>&nbsp;
                    <span class="prd-count">${cart[key].itemCount}</span>
                </li>
            `;
            }
            totalCart += parseInt(cart[key].itemPrice) * cart[key].itemCount;
        });
        getPrdDisplay.textContent = totalCart.toFixed(2);
        
        // for (i of findMyCart.children) {
            // console.log(i.querySelector('.remove'));
            // i.addEventListener('click', function() {
            //     console.log(this);
            // });
        // }
    }

    function addCart(toggle){
        let itemNum = toggle.getAttribute('item-num');
        let itemPrice = toggle.getAttribute('item-price');
        if(cart.hasOwnProperty(`itemNum${itemNum}`)){
            let getTotalCount = cart[`itemNum${itemNum}`].itemCount + 1;
            cart[`itemNum${itemNum}`]['itemCount'] = getTotalCount;
        }else{
            cart[`itemNum${itemNum}`] = {'itemNumber':itemNum,'itemPrice':itemPrice,'itemCount':1};
        }
        items();
    }

    function removeCart(toggle){
        let itemNum = toggle.getAttribute('item-num');
        let itemPrice = toggle.getAttribute('item-price');
        console.log(itemNum,itemPrice);
        if(cart.hasOwnProperty(`itemNum${itemNum}`) && cart[`itemNum${itemNum}`].itemCount != 0){
            let getTotalCount = cart[`itemNum${itemNum}`].itemCount - 1;
            cart[`itemNum${itemNum}`]['itemCount'] = getTotalCount;
        }
        items();
    }

    function checkout(){
        let findMyCart = document.getElementById('mycart');
        findMyCart.innerHTML = '';
        cart = new Object()
        items();
    }

  </script>
</body>
</html>